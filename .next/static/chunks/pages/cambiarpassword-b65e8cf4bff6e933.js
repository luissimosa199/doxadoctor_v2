(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[771],{3188:function(e,a,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cambiarpassword",function(){return o(8827)}])},8827:function(e,a,o){"use strict";o.r(a),o.d(a,{default:function(){return r}});var t=o(5893),n=o(1664),s=o.n(n),i=o(1163),l=o(7294);function r(){let[e,a]=(0,l.useState)(!1),[o,n]=(0,l.useState)(null),[r,d]=(0,l.useState)(!1),[c,m]=(0,l.useState)(!1),u=(0,i.useRouter)(),h=async e=>{e.preventDefault();let o=new FormData(e.currentTarget),t=o.get("email");if(!r){if(c){let e=o.get("code");console.log("mail no validado, codigo enviado 2");let a=await fetch("/api/cambiarpassword/verify",{method:"POST",body:JSON.stringify({email:t,code:e}),headers:{"Content-Type":"application/json"}});a.ok?(console.log("mail validado, codigo enviado"),d(!0)):console.log("error: 2")}else{console.log("mail no validado, codigo no enviado");let e=await fetch("/api/cambiarpassword/verify",{method:"POST",body:JSON.stringify({email:t}),headers:{"Content-Type":"application/json"}});e.ok?(console.log("mail no validado, codigo enviado 1"),m(!0)):console.log("error: 1")}return}a(!0);let s=o.get("newPassword"),i=await fetch("/api/cambiarpassword",{method:"POST",body:JSON.stringify({email:t,newPassword:s,mailValidated:r}),headers:{"Content-Type":"application/json"}}),l=await i.json();i.ok?u.push("/login"):(n(l.error),a(!1))};return(0,t.jsx)("div",{className:"min-h-screen flex justify-center items-center bg-gray-100",children:(0,t.jsxs)("form",{className:"bg-white p-8 rounded-lg shadow-md w-96",onSubmit:h,children:[(0,t.jsxs)("div",{className:"mb-4",children:[!c&&(0,t.jsx)("p",{className:"mb-2",children:"Primero necesitamos validar tu email"}),(0,t.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"email",children:"Email"}),(0,t.jsx)("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",name:"email",type:"email",id:"email",required:!0})]}),c&&!r&&(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"code",children:"Introduce el numero que te ha llegado al email"}),(0,t.jsx)("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",name:"code",type:"code",id:"text",required:!0})]}),r&&(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"newPassword",children:"Nueva Contrase\xf1a"}),(0,t.jsx)("input",{className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",name:"newPassword",type:"password",id:"newPassword",required:!0})]}),o&&(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsxs)("p",{className:"text-sm text-red-600 font-semibold text-center",children:["Error: ",o]})}),(0,t.jsxs)("div",{className:"flex flex-col items-center justify-between",children:[(0,t.jsx)("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition-all",type:"submit",disabled:e,children:r?e?"Cambiando...":"Cambiar Contrase\xf1a":"Verificar email"}),(0,t.jsx)(s(),{href:"/login",className:"text-sm mt-2 text-slate-500 hover:opacity-75 transition-all",children:"Volver al inicio de sesi\xf3n"})]})]})})}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=3188)}),_N_E=e.O()}]);